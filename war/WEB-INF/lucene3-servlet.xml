<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
	
	<bean id="testIndexDirectory" class="net.lucenews3.model.FSDirectoryFactoryBean">
		<property name="path" value="christmascarol" />
	</bean>
	
	<bean id="testIndexBuilder" class="net.lucenews3.model.GutenbergBookIndexer">
		<property name="indexDirectory" ref="testIndexDirectory" />
	</bean>
	
	<bean id="testIndex" class="net.lucenews3.model.IndexImpl">
		<property name="directory" ref="testIndexDirectory" />
		<property name="exceptionTranslator" ref="exceptionTranslator" />
	</bean>

	<bean id="indexRepository"
		class="net.lucenews3.model.IndexRepositoryImpl">
		<constructor-arg>
			<map>
				<entry value-ref="testIndex">
					<key>
						<bean class="net.lucenews3.model.IndexIdentityImpl">
							<constructor-arg value="christmasCarol" />
						</bean>
					</key>
				</entry>
			</map>
		</constructor-arg>
	</bean>

	<bean id="exceptionTranslator"
		class="net.lucenews3.ExceptionTranslatorImpl">
	</bean>

	<bean id="httpIndexIdentityParser"
		class="net.lucenews3.model.HttpIndexIdentityParser">
	</bean>
	
	<bean id="stringQueryParser" class="net.lucenews3.model.NativeQueryParser">
		<property name="queryParser">
			<bean class="org.apache.lucene.queryParser.QueryParser">
				<constructor-arg index="0" value="text" />
				<constructor-arg index="1">
					<bean class="org.apache.lucene.analysis.standard.StandardAnalyzer" />
				</constructor-arg>
			</bean>
		</property>
	</bean>

	<bean id="httpIndexRangeParser" class="net.lucenews3.model.HttpIndexRangeParser">
		<property name="defaultOrdinal" value="1" />
		<property name="defaultSize" value="10" />
		<property name="ordinalParameterName" value="page" />
		<property name="sizeParameterName" value="itemsPerPage" />
	</bean>

	<bean id="httpQueryParser"
		class="net.lucenews3.model.HttpQueryParser">
		<property name="stringParser" ref="stringQueryParser" />
	</bean>

	<bean id="httpFilterParser"
		class="net.lucenews3.model.HttpFilterParser">
	</bean>

	<bean id="httpSortParser"
		class="net.lucenews3.model.HttpSortParser">
	</bean>

	<bean id="httpSearchRequestParser"
		class="net.lucenews3.model.HttpSearchRequestParser">
		<property name="queryParser" ref="httpQueryParser" />
		<property name="filterParser" ref="httpFilterParser" />
		<property name="sortParser" ref="httpSortParser" />
	</bean>

	<bean id="controller" abstract="true"></bean>

	<bean id="indexController" abstract="true" parent="controller">
		<property name="indexIdentityParser"
			ref="httpIndexIdentityParser" />
		<property name="indexesByIdentity" ref="indexRepository" />
	</bean>

	<!-- Service controllers -->
	<bean id="viewServiceController"
		class="net.lucenews3.controller.ViewServiceHttpController"
		parent="controller">
		<property name="indexesByIdentity" ref="indexRepository" />
	</bean>

	<!-- Service properties controllers -->
	<bean id="viewServicePropertiesController"
		class="net.lucenews3.controller.ViewServicePropertiesHttpController"
		parent="controller">
	</bean>

	<!-- Index controllers -->
	<bean id="createIndexController"
		class="net.lucenews3.controller.CreateIndexHttpController"
		parent="indexController">
	</bean>

	<bean id="searchIndexController"
		class="net.lucenews3.controller.SearchIndexHttpController"
		parent="indexController">
		<property name="searchRequestParser"
			ref="httpSearchRequestParser" />
		<property name="indexRangeParser" ref="httpIndexRangeParser" />
	</bean>

	<bean id="removeIndexController"
		class="net.lucenews3.controller.RemoveIndexHttpController"
		parent="indexController">
	</bean>

	<!-- Document controllers -->
	<bean id="createDocumentController"
		class="net.lucenews3.controller.CreateDocumentHttpController"
		parent="controller">
	</bean>

	<bean id="viewDocumentController"
		class="net.lucenews3.controller.ViewDocumentHttpController"
		parent="controller">
	</bean>

	<bean id="removeDocumentController"
		class="net.lucenews3.controller.RemoveDocumentHttpController"
		parent="controller">
	</bean>
	
	<bean id="viewStaticResourceController" class="net.lucenews3.controller.ViewStaticResourceController">
	</bean>

	<bean
		class="net.lucenews3.model.WebServiceHandlerMapping">
		<property name="viewServiceController"
			ref="viewServiceController" />
		<property name="searchIndexController"
			ref="searchIndexController" />
		<property name="viewStaticResourceController" ref="viewStaticResourceController" />
	</bean>
	
	<bean class="net.lucenews3.model.HandlerExceptionResolverImpl">
	</bean>

	<bean class="net.lucenews3.model.Dom4jView">
	</bean>

</beans>
