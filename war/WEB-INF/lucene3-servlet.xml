<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
	
	<bean id="log4jConfigurer" class="net.lucenews3.model.Log4JConfigurer">
	</bean>
	
	<bean id="atomNamespace" class="org.dom4j.Namespace">
		<constructor-arg index="0" value="atom" />
		<constructor-arg index="1" value="http://www.w3.org/2005/Atom" />
	</bean>
	
	<bean id="opensearchNamespace" class="org.dom4j.Namespace">
		<constructor-arg index="0" value="opensearch" />
		<constructor-arg index="1" value="http://a9.com/-/spec/opensearch/1.1/" />
	</bean>

	<bean id="exceptionTranslator"
		class="net.lucenews3.ExceptionTranslatorImpl">
		<property name="customMappings">
			<map key-type="java.lang.Class" value-type="java.lang.Class">
				<entry key="java.lang.NoSuchMethodException" value="net.lucenews3.model.NoSuchMethodRuntimeException" />
			</map>
		</property>
	</bean>
	
	<bean id="christmasCarolIndexDirectory" class="net.lucenews3.model.FSDirectoryFactoryBean">
		<property name="path" value="indexes/christmascarol" />
	</bean>
	
	<bean id="christmasCarolIndexBuilder" class="net.lucenews3.model.GutenbergIndexBuilder">
		<property name="sourceFile" value="test/data/A Christmas Carol by Charles Dickens.txt" />
		<property name="directory" ref="christmasCarolIndexDirectory" />
	</bean>
	
	<bean id="christmasCarolIndex" class="net.lucenews3.model.IndexImpl">
		<property name="directory" ref="christmasCarolIndexDirectory" />
		<property name="exceptionTranslator" ref="exceptionTranslator" />
		<property name="metaData">
			<bean class="net.lucenews3.model.IndexMetaDataImpl">
				<property name="name" value="&quot;A Christmas Carol&quot; by Charles Dickens" />
				<property name="primaryField" value="id" />
				<property name="defaultFields">
					<list>
						<value>text</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>
	
	<bean id="kingJamesBibleIndexDirectory" class="net.lucenews3.model.FSDirectoryFactoryBean">
		<property name="path" value="indexes/kingjames" />
	</bean>
	
	<bean id="kingJamesBibleIndexBuilder" class="net.lucenews3.model.BibleIndexBuilder">
		<property name="sourceFile" value="test/data/kjv12.txt" />
		<property name="directory" ref="kingJamesBibleIndexDirectory" />
	</bean>
	
	<bean id="kingJamesBibleIndex" class="net.lucenews3.model.IndexImpl">
		<property name="directory" ref="kingJamesBibleIndexDirectory" />
		<property name="metaData">
			<bean class="net.lucenews3.model.IndexMetaDataImpl">
				<property name="name" value="The King James Bible" />
				<property name="primaryField" value="id" />
				<property name="defaultFields">
					<list>
						<value>text</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>
	
	<bean id="synonymIndexDirectory" class="net.lucenews3.model.FSDirectoryFactoryBean">
		<property name="path" value="indexes/synonyms" />
	</bean>
	
	<bean id="synonymIndexBuilder" class="net.lucenews3.model.WordnetSynonymIndexBuilder">
		<property name="directoryPath" value="indexes/synonyms" />
		<property name="autoBuild" value="true" />
		<property name="asynchronous" value="false" />
	</bean>
	
	<bean id="synonymSearcher" class="org.apache.lucene.search.IndexSearcher">
		<constructor-arg type="org.apache.lucene.store.Directory" ref="synonymIndexDirectory" />
	</bean>
	
	<bean id="synonymSource" class="net.lucenews3.model.SynonymIndexSource">
		<property name="searcher" ref="synonymSearcher" />
	</bean>
	
	<bean id="spellChecker" class="org.apache.lucene.search.spell.SpellChecker">
		<constructor-arg ref="synonymIndexDirectory" />
	</bean>
	
	<bean id="querySpellChecker" class="net.lucenews3.model.QuerySpellChecker">
		<property name="spellChecker" ref="spellChecker" />
		<property name="exceptionTranslator" ref="exceptionTranslator" />
		<property name="cloner" ref="cloner" />
	</bean>
	
	<bean id="querySynonymExpander" class="net.lucenews3.model.QuerySynonymExpander">
		<property name="synonymSource" ref="synonymSource" />
	</bean>
	
	<bean id="methodResolver" class="net.lucenews3.model.AdaptiveMethodResolver">
	</bean>
	
	<bean id="methodInvoker" class="net.lucenews3.model.MethodInvokerImpl">
		<property name="methodResolver" ref="methodResolver" />
		<property name="exceptionTranslator" ref="exceptionTranslator" />
	</bean>
	
	<bean id="cloner" class="net.lucenews3.model.ClonerImpl">
		<property name="methodInvoker" ref="methodInvoker" />
		<property name="exceptionTranslator" ref="exceptionTranslator" />
	</bean>

	<bean id="indexRepository"
		class="net.lucenews3.model.IndexRepositoryImpl">
		<constructor-arg>
			<map>
				<entry value-ref="christmasCarolIndex">
					<key>
						<bean class="net.lucenews3.model.IndexIdentityImpl">
							<constructor-arg value="christmasCarol" />
						</bean>
					</key>
				</entry>
				<entry value-ref="kingJamesBibleIndex">
					<key>
						<bean class="net.lucenews3.model.IndexIdentityImpl">
							<constructor-arg value="kingJamesBible" />
						</bean>
					</key>
				</entry>
			</map>
		</constructor-arg>
	</bean>
	
	<bean id="indexDiscoverer" class="net.lucenews3.model.IndexDiscoverer">
		<property name="indexesByIdentity" ref="indexRepository" />
	</bean>

	<bean id="httpIndexIdentityParser"
		class="net.lucenews3.model.HttpIndexIdentityParser">
	</bean>
	
	<bean id="httpDocumentIdentityParser" class="net.lucenews3.model.HttpDocumentIdentityParser">
		
	</bean>
	
	<bean id="stringQueryAnalyzer" class="org.apache.lucene.analysis.standard.StandardAnalyzer">
	</bean>
	
	<bean id="stringQueryParser" class="net.lucenews3.queryParser.DelegatingQueryParser">
		<constructor-arg type="java.lang.String" value="text" />
		<constructor-arg type="org.apache.lucene.analysis.Analyzer" ref="stringQueryAnalyzer" />
		<constructor-arg type="net.lucenews3.queryParser.QueryParserDelegate">
			<bean class="net.lucenews3.queryParser.TokenAnnotatingQueryParserDelegate" />
		</constructor-arg>
	</bean>

	<bean id="httpIndexRangeParser" class="net.lucenews3.model.HttpIndexRangeParser">
		<property name="defaultOrdinal" value="1" />
		<property name="defaultSize" value="10" />
		<property name="ordinalParameterName" value="page" />
		<property name="sizeParameterName" value="itemsPerPage" />
	</bean>

	<bean id="httpQueryParser"
		class="net.lucenews3.model.HttpQueryParser">
		<property name="stringParser" ref="stringQueryParser" />
	</bean>

	<bean id="httpFilterParser"
		class="net.lucenews3.model.HttpFilterParser">
	</bean>

	<bean id="httpSortParser"
		class="net.lucenews3.model.HttpSortParser">
	</bean>
	
	<bean id="httpSearchRequestParser"
		class="net.lucenews3.model.HttpSearchRequestParser">
		<property name="queryParser" ref="httpQueryParser" />
		<property name="filterParser" ref="httpFilterParser" />
		<property name="sortParser" ref="httpSortParser" />
	</bean>
	
	<bean id="httpUrlParser" class="net.lucenews3.http.HttpRequestUrlParser">
	</bean>
	
	<bean id="httpBaseUrlParser" class="net.lucenews3.http.HttpRequestBaseUrlParser">
	</bean>

	<bean id="openSearchContextTransformer"
		class="net.lucenews3.opensearch.transform.OpenSearchContextTransformer">
		<property name="atomNamespace" ref="atomNamespace" />
		<property name="openSearchNamespace" ref="opensearchNamespace" />
		<property name="querySpellChecker" ref="querySpellChecker" />
		<property name="querySynonymExpander" ref="querySynonymExpander" />
	</bean>

	<bean id="controller" abstract="true"></bean>

	<bean id="indexController" abstract="true" parent="controller">
		<property name="indexIdentityParser"
			ref="httpIndexIdentityParser" />
		<property name="indexesByIdentity" ref="indexRepository" />
	</bean>

	<!-- Service controllers -->
	<bean id="viewServiceController"
		class="net.lucenews3.controller.ViewServiceHttpController"
		parent="controller">
		<property name="indexesByIdentity" ref="indexRepository" />
		<property name="baseUrlParser" ref="httpBaseUrlParser" />
	</bean>

	<!-- Service properties controllers -->
	<bean id="viewServicePropertiesController"
		class="net.lucenews3.controller.ViewServicePropertiesHttpController"
		parent="controller">
	</bean>

	<!-- Index controllers -->
	<bean id="createIndexController"
		class="net.lucenews3.controller.CreateIndexHttpController"
		parent="indexController">
	</bean>

	<bean id="searchIndexController"
		class="net.lucenews3.controller.SearchIndexHttpController"
		parent="indexController">
		<property name="searchRequestParser"
			ref="httpSearchRequestParser" />
		<property name="indexRangeParser" ref="httpIndexRangeParser" />
		<property name="spellChecker" ref="querySpellChecker" />
		<property name="urlParser" ref="httpUrlParser" />
		<property name="baseUrlParser" ref="httpBaseUrlParser" />
		<property name="searchContextTransformer" ref="openSearchContextTransformer" />
	</bean>

	<bean id="removeIndexController"
		class="net.lucenews3.controller.RemoveIndexHttpController"
		parent="indexController">
	</bean>

	<!-- Document controllers -->
	<bean id="createDocumentController"
		class="net.lucenews3.controller.CreateDocumentHttpController"
		parent="controller">
	</bean>

	<bean id="viewDocumentController"
		class="net.lucenews3.controller.ViewDocumentHttpController"
		parent="controller">
		<property name="indexIdentityParser" ref="httpIndexIdentityParser" />
		<property name="indexesByIdentity" ref="indexRepository" />
		<property name="documentIdentityParser" ref="httpDocumentIdentityParser" />
		<property name="atomNamespace" ref="atomNamespace" />
	</bean>
	
	<bean id="removeDocumentController"
		class="net.lucenews3.controller.RemoveDocumentHttpController"
		parent="controller">
	</bean>
	
	<bean id="viewStaticResourceController" class="net.lucenews3.controller.ViewStaticResourceController">
	</bean>

	<bean
		class="net.lucenews3.model.WebServiceHandlerMapping">
		<property name="urlParser" ref="httpUrlParser" />
		<property name="baseUrlParser" ref="httpBaseUrlParser" />
		<property name="viewServiceController"
			ref="viewServiceController" />
		<property name="searchIndexController"
			ref="searchIndexController" />
		<property name="viewDocumentController" ref="viewDocumentController" />
		<property name="viewStaticResourceController" ref="viewStaticResourceController" />
	</bean>
	
	<bean class="net.lucenews3.model.HandlerExceptionResolverImpl">
	</bean>

	<bean class="net.lucenews3.model.Dom4jView">
		<property name="transformLocation" value="CLIENT" />
	</bean>
	
</beans>
